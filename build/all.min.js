function cos(t){switch(t){case HalfPI:case-PacPI:return 0;case PI:case-PI:return-1;case PacPI:case-HalfPI:return 0;default:return Math.cos(t)}}function sin(t){switch(t){case HalfPI:case-PacPI:return 1;case PI:case-PI:return 0;case PacPI:case-HalfPI:return-1;default:return Math.sin(t)}}function isPowerOfTwo(t){return 0===(t&t-1)}var State=function(){this.startTime=Date.now(),this.frameCount=0,this.dom=document.createElement("div"),this.dom.style.cssText="background:rgba(0, 0, 0, 0.8);position:absolute;top:0;left:0;padding:10px;min-width:180px;height:80px;fontSize:26px;color:green"};State.prototype.update=function(t){var r=Date.now();if(r-this.startTime<1e3)this.frameCount++;else{var e=Math.min(this.frameCount+1,60);this.show(e,t||"[not input!]"),this.startTime=r,this.frameCount=0}},State.prototype.show=function(t,r){this.dom.innerHTML="FPS :"+t+"</br>DRAW:"+r},State.prototype.getDom=function(){return this.dom};var PI=Math.PI,HalfPI=PI/2,PacPI=PI+HalfPI,TwoPI=2*PI,DEG_TO_RAD=PI/180,Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};Matrix._pool=[],Matrix.create=function(){return matrix=Matrix._pool.pop()||new Matrix},Matrix.release=function(t){t.identify(),Matrix._pool.push(t)},Matrix.prototype.identify=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},Matrix.prototype.set=function(t,r,e,i,a,o){this.a=t,this.b=r,this.c=e,this.d=i,this.tx=a,this.ty=o},Matrix.prototype.rotate=function(t){if(t=+t,0!==t){var r=cos(t),e=sin(t),i=this.a,a=this.b,o=this.c,n=this.d,s=this.tx,h=this.ty;this.a=i*r-a*e,this.b=i*e+a*r,this.c=o*r-n*e,this.d=o*e+n*r,this.tx=s*r-h*e,this.ty=s*e+h*r}},Matrix.prototype.scale=function(t,r){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==r&&(this.b*=r,this.d*=r,this.ty*=r)},Matrix.prototype.translate=function(t,r){this.tx+=t,this.ty+=r},Matrix.prototype.append=function(t){var r=this.a,e=this.b,i=this.c,a=this.d,o=this.tx,n=this.ty;this.a=r*t.a+i*t.b,this.b=e*t.a+a*t.b,this.c=r*t.c+i*t.d,this.d=e*t.c+a*t.d,this.tx=r*t.tx+i*t.ty+o,this.ty=e*t.tx+a*t.ty+n},Matrix.prototype.prepend=function(t){var r=this.a,e=this.b,i=this.c,a=this.d,o=this.tx,n=this.ty;this.a=t.a*r+t.c*e,this.b=t.b*r+t.d*e,this.c=t.a*i+t.c*a,this.d=t.b*i+t.d*a,this.tx=t.a*o+t.c*n+t.tx,this.ty=t.b*o+t.d*n+t.ty},Matrix.prototype.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty};var Util={emptyConstructor:function(){},inherit:function(t,r){Util.emptyConstructor.prototype=r.prototype,t.superClass=r.prototype,t.prototype=new Util.emptyConstructor,t.prototype.constructor=t}},DrawData=function(){this.renderType="",this.texture=null,this.color=0,this.transform=null,this.count=0,this.blendMode=""};DrawData.pool=[];for(var i=0;300>i;i++)DrawData.pool.push(new DrawData);DrawData.getObject=function(){return DrawData.pool.length>0?DrawData.pool.pop():new DrawData},DrawData.returnObject=function(t){t.renderType="",t.texture=null,t.color=0,t.transform=null,t.count=0,t.blendMode="",DrawData.pool.push(t)};var Texture=function(t){this.gl=t,this.width=0,this.height=0,this.isInit=!1,this.glTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR)};Texture.prototype.uploadImage=function(t,r){var e=this.gl;r&&e.bindTexture(e.TEXTURE_2D,this.glTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),this.width=t.width,this.height=t.height,this.isInit=!0},Texture.fromImage=function(t,r){var e=new Texture(t);return e.uploadImage(r),e},Texture.fromSrc=function(t,r){var e=new Texture(t),i=new Image;return i.src=r,i.onload=function(){e.uploadImage(i,!0)},e};var RenderTexture=function(t,r,e){RenderTexture.superClass.constructor.call(this,t),r&&e&&this.resize(r,e)};Util.inherit(RenderTexture,Texture),RenderTexture.prototype.resize=function(t,r,e){var i=this.gl;e&&i.bindTexture(i.TEXTURE_2D,this.glTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,i.UNSIGNED_BYTE,null),this.isInit=!0};var Render=function(t){this.view=t,this.gl=t.getContext("webgl",{antialias:!1,stencil:!0}),this.width=t.clientWidth,this.height=t.clientHeight,this.rootRenderTarget=new RenderTarget(this.gl,this.width,this.height,!0),this.currentRenderTarget=null,this.activateRenderTarget(this.rootRenderTarget),this.rootRenderBuffer=new RenderBuffer(this.gl),this.currentRenderBuffer=null,this.activateRenderBuffer(this.rootRenderBuffer),this.textureShader=new TextureShader(this.gl),this.primitiveShader=new PrimitiveShader(this.gl),this.colorTransformShader=new ColorTransformShader(this.gl),this.currentShader=null,this.drawCall=0,this.defaultBlendMode="source-over";var r=this.gl;r.disable(r.STENCIL_TEST),r.disable(r.DEPTH_TEST),r.enable(r.BLEND),this.setBlendMode(this.defaultBlendMode)};Object.defineProperties(Render.prototype,{context:{get:function(){return this.gl}}}),Render.prototype.activateShader=function(t){if(this.currentShader!=t){var r=this.gl;t.activate(r,this.width,this.height),this.currentShader=t}},Render.prototype.activateRenderTarget=function(t){this.currentRenderTarget!=t&&(t.activate(),this.currentRenderTarget=t)},Render.prototype.activateRenderBuffer=function(t){this.currentRenderBuffer!=t&&(t.activate(),this.currentRenderBuffer=t)},Render.prototype.render=function(t){return this.drawCall=0,this._render(t),this.flush(),this.drawCall},Render.prototype._render=function(t){this.currentRenderBuffer.reachedMaxSize()&&this.flush();var r=this.currentRenderBuffer.transform,e=Matrix.create();if(e.copy(r),r.append(t.getTransformMatrix()),t.blend!=this.defaultBlendMode&&this.currentRenderBuffer.cacheBlendMode(t.blend),"container"==t.renderType)for(var i=t.children.length,a=0;i>a;a++){var o=t.children[a];this._render(o)}else this.currentRenderBuffer.cache(t);t.blend!=this.defaultBlendMode&&this.currentRenderBuffer.cacheBlendMode(this.defaultBlendMode),r.copy(e),Matrix.release(e)},Render.prototype.flush=function(){this.drawWebGL(),this.currentRenderBuffer.clear()},Render.prototype.drawWebGL=function(){var t=this.gl;this.currentRenderBuffer.upload();for(var r=0,e=this.currentRenderBuffer.currentSize,i=this.currentRenderBuffer.drawData,a=0;e>a;a++){var o=i[a];switch(o.renderType){case"sprite":var n=o.count;if(o.texture&&o.texture.isInit){if(o.filters.length>0)for(var s=o.filters.length,h=0;s>h;h++)o.filters[h].applyFilter(render);else this.activateShader(this.textureShader);t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,o.texture.glTexture),t.drawElements(t.TRIANGLES,6*n,t.UNSIGNED_SHORT,2*r),this.drawCall++}r+=6*n;break;case"rect":var n=o.count;this.activateShader(this.primitiveShader),this.primitiveShader.fillColor(t,o.color),t.drawElements(t.TRIANGLES,6*n,t.UNSIGNED_SHORT,2*r),this.drawCall++,r+=6*n;break;case"blend":var c=o.blendMode;this.setBlendMode(c);break;default:console.warn("no render type function")}}t.bindTexture(t.TEXTURE_2D,null)},Render.prototype.setBlendMode=function(t){var r=this.gl;switch(t){case"source-over":r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case"lighter":r.blendFunc(r.SRC_ALPHA,r.ONE);break;case"destination-out":r.blendFunc(r.ZERO,r.ONE_MINUS_SRC_ALPHA);break;case"destination-in":r.blendFunc(r.ZERO,r.SRC_ALPHA)}},Render.prototype.clear=function(){this.currentRenderTarget.clear()};var RenderTarget=function(t,r,e,i){this.gl=t,this.root=i,this.frameBuffer=null,this.texture=null,this.width=r,this.height=e,this.clearColor=[0,0,0,0],this.root||(this.frameBuffer=t.createFramebuffer(),this.texture=new RenderTexture(t,r,e),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture.glTexture,0))};RenderTarget._pool=[],RenderTarget.create=function(t,r,e){var i=RenderTarget._pool.pop();return i?(i.width==r&&i.height==e?i.clear():i.resize(r,e),i):new RenderTarget(t,r,e)},RenderTarget.release=function(t){RenderTarget._pool.push(t)},RenderTarget.prototype.resize=function(t,r){this.texture.resize(t,r,!0)},RenderTarget.prototype.clear=function(t){var r=this.gl;t&&r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),r.clear(r.COLOR_BUFFER_BIT)},RenderTarget.prototype.attachStencilBuffer=function(){},RenderTarget.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer)},RenderTarget.prototype.destroy=function(){};var RenderBuffer=function(t){this.gl=t,this.size=2e3,this.drawData=[],this.currentBitch=0,this.currentSize=0,this.vertices=new Float32Array(4*this.size*4),this.vertexBuffer=t.createBuffer(),this.indices=new Uint16Array(6*this.size),this.indexBuffer=t.createBuffer(),this.transform=new Matrix};RenderBuffer.prototype.activate=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},RenderBuffer.prototype.upload=function(){var t=this.gl,r=this.vertices.subarray(0,4*this.currentBitch*4);t.bufferData(t.ARRAY_BUFFER,r,t.STREAM_DRAW);var e=this.indices.subarray(0,6*this.currentBitch);t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)},RenderBuffer.prototype.reachedMaxSize=function(){return this.currentBitch>=this.size},RenderBuffer.prototype.cache=function(t){for(var r=(this.gl,this.transform),e=t.getVertices(r),i=0;i<e.length;i++)this.vertices[4*this.currentBitch*4+i]=e[i];for(var a=t.getIndices(r),i=0;i<a.length;i++)this.indices[6*this.currentBitch+i]=a[i]+4*this.currentBitch;var o=t.renderType,n=null;switch(o){case"sprite":(t.filters.length>0||0==this.currentSize||"sprite"!=this.drawData[this.currentSize-1].renderType||this.drawData[this.currentSize-1].texture!=t.texture)&&(n=t.getDrawData(),n.renderType=t.renderType,this.drawData[this.currentSize]=n,this.currentSize++);break;case"rect":(t.filters.length>0||0==this.currentSize||"rect"!=this.drawData[this.currentSize-1].renderType||this.drawData[this.currentSize-1].color!=t.color)&&(n=t.getDrawData(),n.renderType=t.renderType,this.drawData[this.currentSize]=n,this.currentSize++);break;default:console.warn("no render type function")}this.currentBitch++,this.drawData[this.currentSize-1].count++},RenderBuffer.prototype.cacheBlendMode=function(t){if(this.currentSize>0)for(var r=!1,e=this.currentSize-1;e>0;e--){var i=this.drawData[e];if("blend"!=i.renderType&&(r=!0),r||"blend"!=i.renderType){if("blend"==i.renderType){if(i.blendMode==t)return;break}}else this.drawData.splice(e,1),this.currentSize--}var i=DrawData.getObject();i.renderType="blend",i.blendMode=t,this.drawData[this.currentSize]=i,this.currentSize++},RenderBuffer.prototype.clear=function(){for(var t=0;t<this.drawData.length;t++)DrawData.returnObject(this.drawData[t]);this.drawData.length=0,this.currentBitch=0,this.currentSize=0};var Shader=function(t,r,e){this.vshaderSource=r,this.fshaderSource=e,this.vertexShader=this._loadShader(t,t.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=this._loadShader(t,t.FRAGMENT_SHADER,this.fshaderSource),this.program=this._createProgram(t)};Shader.prototype.activate=function(t,r,e){t.useProgram(this.program);var i=t.getUniformLocation(this.program,"u_Projection");t.uniform2f(i,r/2,e/2)},Shader.prototype._createProgram=function(t){var r=t.createProgram();return t.attachShader(r,this.vertexShader),t.attachShader(r,this.fragmentShader),t.linkProgram(r),r},Shader.prototype._loadShader=function(t,r,e){var i=t.createShader(r);t.shaderSource(i,e),t.compileShader(i);var a=t.getShaderParameter(i,t.COMPILE_STATUS);return a||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(i))),i};var PrimitiveShader=function(t){var r=["attribute vec2 a_Position;","uniform vec2 u_Projection;","const vec2 center = vec2(1.0, 1.0);","void main() {","gl_Position = vec4(a_Position / u_Projection - center, 0.0, 1.0);","}"].join("\n"),e=["precision mediump float;","uniform vec4 u_Color;","void main() {","gl_FragColor = u_Color;","}"].join("\n");PrimitiveShader.superClass.constructor.call(this,t,r,e)};Util.inherit(PrimitiveShader,Shader),PrimitiveShader.prototype.activate=function(t,r,e){PrimitiveShader.superClass.activate.call(this,t,r,e);var i=t.getAttribLocation(this.program,"a_Position"),a=4;t.vertexAttribPointer(i,2,t.FLOAT,!1,4*a,0),t.enableVertexAttribArray(i),this.fillColor(t,16776960)},PrimitiveShader.prototype.fillColor=function(t,r){var e=t.getUniformLocation(this.program,"u_Color"),i=parseInt(r,10),a=i/65536,o=i%65536/256,n=i%256/1;t.uniform4f(e,a/256,o/256,n/256,1)};var TextureShader=function(t){var r=["attribute vec2 a_Position;","attribute vec2 a_TexCoord;","varying vec2 v_TexCoord;","uniform vec2 u_Projection;","const vec2 center = vec2(1.0, 1.0);","void main() {","gl_Position = vec4(a_Position / u_Projection - center, 0.0, 1.0);","v_TexCoord = a_TexCoord;","}"].join("\n"),e=["precision mediump float;","uniform sampler2D u_Sampler;","varying vec2 v_TexCoord;","void main() {","gl_FragColor = texture2D(u_Sampler, v_TexCoord);","}"].join("\n");TextureShader.superClass.constructor.call(this,t,r,e)};Util.inherit(TextureShader,Shader),TextureShader.prototype.activate=function(t,r,e){TextureShader.superClass.activate.call(this,t,r,e);var i=t.getAttribLocation(this.program,"a_Position"),a=t.getAttribLocation(this.program,"a_TexCoord"),o=4;t.vertexAttribPointer(i,2,t.FLOAT,!1,4*o,0),t.enableVertexAttribArray(i),t.vertexAttribPointer(a,2,t.FLOAT,!1,4*o,2*o),t.enableVertexAttribArray(a);var n=t.getUniformLocation(this.program,"u_Sampler");t.uniform1i(n,0)};var ColorTransformShader=function(t){var r=["attribute vec2 a_Position;","attribute vec2 a_TexCoord;","varying vec2 v_TexCoord;","uniform vec2 u_Projection;","const vec2 center = vec2(1.0, 1.0);","void main() {","gl_Position = vec4(a_Position / u_Projection - center, 0.0, 1.0);","v_TexCoord = a_TexCoord;","}"].join("\n"),e=["precision mediump float;","uniform sampler2D u_Sampler;","varying vec2 v_TexCoord;","uniform mat4 u_Matrix;","uniform vec4 u_ColorAdd;","void main() {","vec4 texColor = texture2D(u_Sampler, v_TexCoord);","vec4 locColor = texColor * u_Matrix;","if (locColor.a != 0.0) {","locColor += u_ColorAdd * locColor.a;","}","gl_FragColor = locColor;","}"].join("\n");ColorTransformShader.superClass.constructor.call(this,t,r,e),this.transform=new Float32Array(16),this.colorAdd=new Float32Array(4)};Util.inherit(ColorTransformShader,Shader),ColorTransformShader.prototype.activate=function(t,r,e){TextureShader.superClass.activate.call(this,t,r,e);var i=t.getAttribLocation(this.program,"a_Position"),a=t.getAttribLocation(this.program,"a_TexCoord"),o=4;t.vertexAttribPointer(i,2,t.FLOAT,!1,4*o,0),t.enableVertexAttribArray(i),t.vertexAttribPointer(a,2,t.FLOAT,!1,4*o,2*o),t.enableVertexAttribArray(a);var n=t.getUniformLocation(this.program,"u_Sampler");t.uniform1i(n,0)},ColorTransformShader.prototype.setMatrix=function(t,r){var e=t.getUniformLocation(this.program,"u_Matrix"),i=t.getUniformLocation(this.program,"u_ColorAdd");this.transform[0]=r[0],this.transform[1]=r[1],this.transform[2]=r[2],this.transform[3]=r[3],this.transform[4]=r[5],this.transform[5]=r[6],this.transform[6]=r[7],this.transform[7]=r[8],this.transform[8]=r[10],this.transform[9]=r[11],this.transform[10]=r[12],this.transform[11]=r[13],this.transform[12]=r[15],this.transform[13]=r[16],this.transform[14]=r[17],this.transform[15]=r[18],this.colorAdd[0]=r[4]/255,this.colorAdd[1]=r[9]/255,this.colorAdd[2]=r[14]/255,this.colorAdd[3]=r[19]/255,t.uniformMatrix4fv(e,!1,this.transform),t.uniform4fv(i,this.colorAdd)};var GrayShader=function(t){var r=["attribute vec2 a_Position;","attribute vec2 a_TexCoord;","varying vec2 v_TexCoord;","uniform vec2 u_Projection;","const vec2 center = vec2(1.0, 1.0);","void main() {","gl_Position = vec4(a_Position / u_Projection - center, 0.0, 1.0);","v_TexCoord = a_TexCoord;","}"].join("\n"),e=["precision mediump float;","uniform sampler2D u_Sampler;","varying vec2 v_TexCoord;","void main() {","vec4 color = texture2D(u_Sampler, v_TexCoord);","float gray = (color.r + color.g + color.b) / 3.0;","gl_FragColor = vec4(gray, gray, gray, color.a);","}"].join("\n");GrayShader.superClass.constructor.call(this,t,r,e)};Util.inherit(GrayShader,Shader),GrayShader.prototype.activate=function(t,r,e){TextureShader.superClass.activate.call(this,t,r,e);var i=t.getAttribLocation(this.program,"a_Position"),a=t.getAttribLocation(this.program,"a_TexCoord"),o=4;t.vertexAttribPointer(i,2,t.FLOAT,!1,4*o,0),t.enableVertexAttribArray(i),t.vertexAttribPointer(a,2,t.FLOAT,!1,4*o,2*o),t.enableVertexAttribArray(a);var n=t.getUniformLocation(this.program,"u_Sampler");t.uniform1i(n,0)};var AbstractFilter=function(t){this.shader=null};AbstractFilter.prototype.applyFilter=function(t){};var ColorTransformFilter=function(t){this.shader=new ColorTransformShader(t),this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]};Util.inherit(ColorTransformFilter,AbstractFilter),ColorTransformFilter.prototype.reset=function(){this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.brightness=function(t){this.matrix=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.grayScale=function(t){this.matrix=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.blackAndWhite=function(t){this.matrix=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.hue=function(t){t=(t||0)/180*Math.PI;var r=Math.cos(t),e=Math.sin(t),i=.213,a=.715,o=.072;this.matrix=[i+r*(1-i)+e*-i,a+r*-a+e*-a,o+r*-o+e*(1-o),0,0,i+r*-i+.143*e,a+r*(1-a)+.14*e,o+r*-o+e*-.283,0,0,i+r*-i+e*-(1-i),a+r*-a+e*a,o+r*(1-o)+e*o,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.contrast=function(t){var r=(t||0)+1,e=-128*(r-1);this.matrix=[r,0,0,0,e,0,r,0,0,e,0,0,r,0,e,0,0,0,1,0]},ColorTransformFilter.prototype.saturate=function(t){var r=2*(t||0)/3+1,e=(r-1)*-.5;this.matrix=[r,e,e,0,0,e,r,e,0,0,e,e,r,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.desaturate=function(t){this.saturate(-1)},ColorTransformFilter.prototype.negative=function(){this.matrix=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0]},ColorTransformFilter.prototype.applyFilter=function(t){t.activateShader(this.shader),this.shader.setMatrix(t.context,this.matrix)};var GrayFilter=function(t){this.shader=new GrayShader(t)};Util.inherit(GrayFilter,AbstractFilter),GrayFilter.prototype.applyFilter=function(t){t.activateShader(this.shader)};var DisplayObject=function(){this.renderType="",this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.anchorX=0,this.anchorY=0,this.transform=new Matrix,this.width=0,this.height=0,this.filters=[],this.blend="source-over"};DisplayObject.prototype.getVertices=function(){},DisplayObject.prototype.getIndices=function(){},DisplayObject.prototype.getDrawData=function(t){},DisplayObject.prototype.getTransformMatrix=function(){return this.transform.identify(),this.transform.translate(-this.anchorX*this.width,-this.anchorY*this.height),this.transform.scale(this.scaleX,this.scaleY),this.transform.rotate(this.rotation),this.transform.translate(this.x,this.y),this.transform};var DisplayObjectContainer=function(){DisplayObjectContainer.superClass.constructor.call(this),this.renderType="container",this.children=[]};Util.inherit(DisplayObjectContainer,DisplayObject),DisplayObject.prototype.addChild=function(t){this.children.push(t)},DisplayObject.prototype.removeChild=function(t){for(var r=0;r<this.children.length;){var e=this.children[r];if(e==t){this.children.splice(r,1);break}r++}};var Sprite=function(){Sprite.superClass.constructor.call(this),this.renderType="sprite",this.texture=null};Util.inherit(Sprite,DisplayObject),Sprite.prototype.getVertices=function(t){var r=t,e=[],i=0,a=0;e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,0,0);var i=0+this.width,a=0;e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,1,0);var i=0+this.width,a=0+this.height;e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,1,1);var i=0,a=0+this.height;return e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,0,1),e},Sprite.prototype.getIndices=function(){return[0,1,2,2,3,0]},Sprite.prototype.getDrawData=function(){var t=DrawData.getObject();return t.texture=this.texture,t.filters=this.filters,t};var Rect=function(){Rect.superClass.constructor.call(this),this.renderType="rect",this.color=0};Util.inherit(Rect,DisplayObject),Rect.prototype.getVertices=function(t){var r=t,e=[],i=0,a=0;e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,0,0);var i=0+this.width,a=0;e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,1,0);var i=0+this.width,a=this.y+this.height;e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,1,1);var i=0,a=this.y+this.height;return e.push(r.a*i+r.c*a+r.tx,r.b*i+r.d*a+r.ty,0,1),e},Rect.prototype.getIndices=function(){return[0,1,2,2,3,0]},Rect.prototype.getDrawData=function(){var t=DrawData.getObject();return t.color=this.color,t};